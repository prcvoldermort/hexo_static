{"meta":{"title":"æœæœå®¶","subtitle":"è®°å½•ä¸­","description":null,"author":"Zhang Yuan","url":"http://blog.guoguojia.net"},"pages":[{"title":"tags","date":"2019-01-01T10:09:29.000Z","updated":"2019-01-01T10:10:25.483Z","comments":false,"path":"tags/index.html","permalink":"http://blog.guoguojia.net/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2019-01-01T10:10:35.000Z","updated":"2019-01-01T10:11:08.391Z","comments":false,"path":"categories/index.html","permalink":"http://blog.guoguojia.net/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"Javascriptä¸­çš„å¼‚æ­¥æ“ä½œä¸€--å›è°ƒ","slug":"Javascriptä¸­çš„å¼‚æ­¥æ“ä½œä¸€-å›è°ƒå‡½æ•°","date":"2019-01-08T04:20:40.000Z","updated":"2019-01-08T04:20:40.864Z","comments":true,"path":"2019/01/08/Javascriptä¸­çš„å¼‚æ­¥æ“ä½œä¸€-å›è°ƒå‡½æ•°/","link":"","permalink":"http://blog.guoguojia.net/2019/01/08/Javascriptä¸­çš„å¼‚æ­¥æ“ä½œä¸€-å›è°ƒå‡½æ•°/","excerpt":"","text":"æœ¬æ–‡ç¿»è¯‘è‡ª(https://javascript.info/callbacks)[https://javascript.info/callbacks] å›è°ƒJavaScriptä¸­æœ‰è®¸å¤šæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä¾‹å¦‚ä¸‹é¢çš„loadScript(src): 12345function loadScript(src) &#123; let script = document.createElement('script'); script.src = src; document.head.append(script);&#125; è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥åŠ è½½æ–°çš„è„šæœ¬çš„ï¼Œè¿è¡Œæ—¶æŠŠ&lt;script src=&quot;â€¦&quot;&gt;æ·»åŠ åˆ°æ–‡æ¡£æµä¸­ï¼Œå½“æµè§ˆå™¨è§£æåˆ°è¿™ä¸ªåœ°æ–¹æ—¶æ‰§è¡Œã€‚å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š12// åŠ è½½å¹¶æ‰§è¡Œè„šæœ¬loadScript('/my/script.js'); è¿™ä¸ªæ–¹æ³•è¢«ç§°ä¸ºå¼‚æ­¥å‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªåŠ è½½è„šæœ¬çš„æ“ä½œä¸æ˜¯ç«‹åˆ»å®Œæˆï¼Œè€Œæ˜¯ç¨åå®Œæˆçš„ã€‚ è¿™ä¸ªæ–¹æ³•é¦–å…ˆåˆå§‹åŒ–è„šæœ¬ï¼Œç„¶åæ‰§è¡Œä»£ç ã€‚åœ¨è„šæœ¬åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ä¸‹çš„ä»£ç æœ‰å¯èƒ½å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œå¦‚æœè¿™ä¸ªè¿‡ç¨‹éå¸¸è€—æ—¶ï¼Œé‚£å…¶ä½™çš„ä»£ç ä¹Ÿæœ‰å¯èƒ½åŒæ—¶æ‰§è¡Œã€‚ 123loadScript('/my/script.js');// loadScriptæ–¹æ³•ä¸‹é¢çš„ä»£ç ä¸ä¼šç­‰å¾…å…¶æ‰§è¡Œå®Œæ¯•æ‰å¼€å§‹æ‰§è¡Œ// ... å‡è®¾æˆ‘ä»¬æƒ³è°ƒç”¨é€šè¿‡loadScriptæ–¹æ³•åŠ è½½åˆ°çš„ä»£ç ä¸­çš„newFunctionæ–¹æ³•ï¼Œä½ ä¼šå‘ç°ä¸‹é¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼š 123loadScript('/my/script.js'); // è„šæœ¬ä¸­æœ‰\"function newFunction() &#123;â€¦&#125;\"newFunction(); // æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼ï¼ï¼ æµè§ˆå™¨å¯èƒ½æ¥ä¸åŠåŠ è½½å®Œæ•´çš„è„šæœ¬ï¼Œå› æ­¤ç«‹å³è°ƒç”¨newFunctionæ–¹æ³•ä¼šå¤±è´¥ï¼Œåœ¨å½“å‰çš„æƒ…å†µä¸‹ï¼ŒloadScriptæ–¹æ³•ä¸èƒ½è¿½è¸ªä»£ç åŠ è½½çš„å®Œæˆä¸å¦ï¼Œè„šæœ¬åŠ è½½å¹¶æœ€ç»ˆæ‰§è¡Œï¼Œè¿™å°±æ˜¯è¿™æ®µä»£ç åšçš„äº‹æƒ…ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦çŸ¥é“å…·ä½“ä»€ä¹ˆæ—¶é—´åŠ è½½ï¼Œä»€ä¹ˆæ—¶å€™å¼€å§‹æ‰§è¡Œæ‰èƒ½æ­£ç¡®ä½¿ç”¨è„šæœ¬ä¸­çš„æ–°æ–¹æ³•å’Œå˜é‡ã€‚ æˆ‘ä»¬æ¥ä¸ºloadSciptæ–¹æ³•åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•°callbackï¼Œæ¥ä½œä¸ºè„šæœ¬åŠ è½½å®Œåæ‰§è¡Œçš„å›è°ƒã€‚ 12345678function loadScript(src, callback) &#123; let script = document.createElement('script'); script.src = src; script.onload = () =&gt; callback(script); document.head.append(script);&#125; ç°åœ¨å¯ä»¥å°†è„šæœ¬ä¸­å®šä¹‰çš„æ–¹æ³•å†™åœ¨å›è°ƒä¸­æ¥è°ƒç”¨å®ƒï¼š 12345loadScript('/my/script.js', function() &#123; // the callback runs after the script is loaded newFunction(); // ç°åœ¨å¯ä»¥æ‰§è¡Œäº† ...&#125;); è¿™å°±å¯¹äº†ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è„šæœ¬åŠ è½½å®Œæˆåæ‰§è¡Œçš„å‡½æ•°(é€šå¸¸æ˜¯åŒ¿åå‡½æ•°). ä»¥ä¸‹æ˜¯ä¸€ä¸ªç°å®ä¸­çš„å¯æ‰§è¡Œçš„ç¤ºä¾‹: 1234567891011function loadScript(src, callback) &#123; let script = document.createElement('script'); script.src = src; script.onload = () =&gt; callback(script); document.head.append(script);&#125;loadScript('https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.2.0/lodash.js', script =&gt; &#123; alert(`Cool, the $&#123;script.src&#125; is loaded`); alert( _ ); // function declared in the loaded script&#125;); è¿™å°±æ˜¯æ‰€è°“çš„â€åŸºäºå›è°ƒçš„â€å¼‚æ­¥ç¼–ç¨‹æ–¹å¼ï¼Œä¸€ä¸ªå¼‚æ­¥æ‰§è¡Œçš„æ–¹æ³•åº”è¯¥åŒ…æ‹¬ä¸€ä¸ªå›è°ƒæ–¹æ³•ä¾›å…¶æ‰§è¡Œå®Œæ¯•åè°ƒç”¨ã€‚ è¿™é‡Œæ˜¯ä»¥loadScriptä¸ºä¾‹æ¥è¯´æ˜çš„ï¼Œæ˜¯ä¸€ç§é€šè¡Œçš„åšæ³•ã€‚ å›è°ƒä¸­çš„å›è°ƒé‚£ä¹ˆå¦‚ä½•é¡ºåºåŠ è½½ä¸¤æ®µè„šæœ¬å‘¢ï¼Ÿ è‡ªç„¶è€Œç„¶ä¼šæƒ³åˆ°æŠŠç¬¬äºŒæ®µloadScriptè„šæœ¬æ”¾åœ¨ç¬¬ä¸€æ®µloadScriptè„šæœ¬çš„å›è°ƒä¸­: 123456789loadScript('/my/script.js', function(script) &#123; alert(`Cool, the $&#123;script.src&#125; is loaded, let's load one more`); loadScript('/my/script2.js', function(script) &#123; alert(`Cool, the second script is loaded`); &#125;);&#125;); å½“å¤–å±‚çš„loadScriptåŠ è½½å®Œæ¯•åï¼Œå†åŠ è½½é‡Œé¢çš„å›è°ƒã€‚ é‚£å¦‚æœå†åŠ æ›´å¤šå±‚çš„è„šæœ¬å‘¢ï¼Ÿ 1234567891011loadScript('/my/script.js', function(script) &#123; loadScript('/my/script2.js', function(script) &#123; loadScript('/my/script3.js', function(script) &#123; // ...continue after all scripts are loaded &#125;); &#125;)&#125;); æ¯ä¸€ä¸ªæ–°çš„æ–¹æ³•éƒ½åµŒå¥—åœ¨ä¸€ä¸ªå›è°ƒä¸­ï¼Œè¿™æ ·å¤šå‡ å±‚è¿˜è¡Œï¼Œå†å¤šå±‚å°±ä¸å¥½ä½¿äº†ï¼Œéšåæˆ‘ä»¬ä¼šçœ‹åˆ°å…¶ä»–çš„å˜é€šæ–¹æ³•ã€‚ é”™è¯¯å¤„ç†åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬æ²¡æœ‰è€ƒè™‘é”™è¯¯çš„æƒ…å†µã€‚å‡å¦‚è„šæœ¬åŠ è½½å¤±è´¥å‘¢ï¼Œæˆ‘ä»¬çš„ä»£ç ç†åº”å¯¹é”™è¯¯åšå‡ºååº”ã€‚ è¿™æ˜¯å¯ä»¥è¿½è¸ªåŠ è½½é”™è¯¯çš„loadScriptæ”¹è¿›ç‰ˆæœ¬ä»£ç ï¼š 123456789function loadScript(src, callback) &#123; let script = document.createElement('script'); script.src = src; script.onload = () =&gt; callback(null, script); script.onerror = () =&gt; callback(new Error(`Script load error for $&#123;src&#125;`)); document.head.append(script);&#125; å¯¹äºæˆåŠŸçš„åŠ è½½è°ƒç”¨callback(null, script), å¯¹äºå¤±è´¥çš„åŠ è½½è°ƒç”¨callback(error). ä½¿ç”¨æ–¹æ³•ï¼š 1234567loadScript(&apos;/my/script.js&apos;, function(error, script) &#123; if (error) &#123; // å¤„ç†é”™è¯¯ &#125; else &#123; // è„šæœ¬æˆåŠŸåŠ è½½ &#125;&#125;); ä»¥ä¸Šçš„ç”¨æ³•éå¸¸å¸¸è§ï¼Œç§°ä½œâ€é”™è¯¯ä¼˜å…ˆå›è°ƒâ€. çº¦å®šå¦‚ä¸‹ï¼š å›è°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¿ç•™ç”¨ä½œé”™è¯¯å¤„ç†ï¼Œå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œè°ƒç”¨callback(err) ç¬¬äºŒä¸ªåŠåé¢çš„å‚æ•°ä¾›æˆåŠŸçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œç„¶åè°ƒç”¨callback(null, result1, result2â€¦) è¿™æ ·callbackæ–¹æ³•å°±å¯ä»¥åŒæ—¶ç”¨æ¥æŠ¥é”™å’Œè¿”å›ç»“æœäº†ã€‚ åµŒå¥—çš„å™©æ¢¦ç¬¬ä¸€çœ¼çœ‹ä¸Šå»ï¼Œè¿™ç§å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼åˆ‡å®å¯è¡Œï¼Œå¯¹äºä¸€åˆ°ä¸¤å±‚çš„åµŒå¥—çœ‹ä¸Šå»ä¸é”™ï¼Œä½†æ˜¯å¯¹äºæ›´å¤šå±‚çš„åµŒå¥—å°±ä¸æ˜¯è¿™ä¹ˆå›äº‹äº†ï¼š 1234567891011121314151617181920212223loadScript('1.js', function(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ... loadScript('2.js', function(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ... loadScript('3.js', function(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ...åœ¨æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å¥½åæ‰§è¡Œ (*) &#125; &#125;); &#125; &#125;) &#125;&#125;); ä¸Šé¢çš„ä»£ç ä¸­ï¼š åŠ è½½1.jsï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œç„¶å åŠ è½½2.js, å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œç„¶å åŠ è½½3.jsï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œç„¶åç»§ç»­æ‰§è¡Œ å½“åµŒå¥—æ›´å¤šçš„å±‚çº§æ—¶ï¼Œä»£ç å°±ä¼šè¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ï¼Œç‰¹åˆ«æ˜¯...å¤„æ¢æˆåŒ…å«å„ç§å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­çš„çœŸå®çš„ä»£ç ã€‚ è¿™å°±è¢«ç§°ä½œå›è°ƒåœ°ç‹±æˆ–åµŒå¥—çš„å™©æ¢¦ã€‚ è¿™ç§ä»£ç ä¸æ˜¯éå¸¸å¥½ï¼Œå¯ä»¥å°è¯•æŠŠæ¯ä¸€æ­¥å†™æˆå•ç‹¬çš„æ–¹æ³•æ¥ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œåƒè¿™æ ·ï¼š 123456789101112131415161718192021222324252627loadScript('1.js', step1);function step1(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ... loadScript('2.js', step2); &#125;&#125;function step2(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ... loadScript('3.js', step3); &#125;&#125;function step3(error, script) &#123; if (error) &#123; handleError(error); &#125; else &#123; // ...continue after all scripts are loaded (*) &#125;&#125;; è¿™æ®µä»£ç æŠŠä»£ç çš„åµŒå¥—å†™æˆäº†å•ç‹¬çš„æ–¹æ³•ï¼Œåšçš„äº‹æƒ…è¿˜æ˜¯ä¸€æ ·çš„ã€‚ è¿™ç§æ–¹æ³•èµ·ä½œç”¨ï¼Œä½†ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€æ®µæ’•ç¢çš„ç”µå­è¡¨æ ¼ï¼Œéœ€è¦çœ¼çƒè·³æ¥è·³å»ï¼Œå¾ˆéš¾é˜…è¯»ã€‚è¿™å¾ˆä¸æ–¹ä¾¿ï¼Œç‰¹åˆ«æ˜¯è¯»è€…ä¸ç†Ÿæ‚‰ä»£ç çš„æƒ…å†µä¸‹éƒ½ä¸çŸ¥é“çœ¼çƒåº”è¯¥æ”¾å“ªé‡Œã€‚ è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å‘½åä¸ºstep*çš„æ–¹æ³•æ˜¯ç”¨æ¥é¿å…åµŒå¥—å™©æ¢¦çš„ï¼Œéƒ½åªèƒ½ç”¨ä¸€æ¬¡ï¼Œæ²¡æœ‰äººä¼šåœ¨æ–¹æ³•é“¾å¤–å†æ¬¡ä½¿ç”¨ï¼Œå› æ­¤å¯èƒ½ä¼šé€ æˆå‘½åç©ºé—´çš„æ··æ‚ã€‚ æˆ‘ä»¬éœ€è¦æ›´å¥½çš„æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ å¹¸è¿çš„æ˜¯ï¼Œçš„ç¡®æœ‰åŠæ³•å¯ä»¥é¿å…è¿™æ ·çš„å™©æ¢¦ï¼Œé‚£å°±æ˜¯ä¸‹ä¸€ç« ä»‹ç»çš„promisesï¼ˆä¿è¯ï¼‰ã€‚","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"http://blog.guoguojia.net/tags/Javascript/"},{"name":"è¯­æ³•","slug":"è¯­æ³•","permalink":"http://blog.guoguojia.net/tags/è¯­æ³•/"},{"name":"å¼‚æ­¥æ“ä½œ","slug":"å¼‚æ­¥æ“ä½œ","permalink":"http://blog.guoguojia.net/tags/å¼‚æ­¥æ“ä½œ/"}]},{"title":"Laravelæœ€ä½³å®è·µ","slug":"laravel-best-practices","date":"2019-01-03T03:42:41.000Z","updated":"2019-01-03T07:03:48.270Z","comments":true,"path":"2019/01/03/laravel-best-practices/","link":"","permalink":"http://blog.guoguojia.net/2019/01/03/laravel-best-practices/","excerpt":"","text":"ç¿»è¯‘è‡ªï¼šhttps://github.com/alexeymezenin/laravel-best-practices contentså•ä¸€è´£ä»»åŸåˆ™èƒ–æ¨¡å‹ï¼Œç˜¦æ§åˆ¶å™¨æ ¡éªŒä¸šåŠ¡é€»è¾‘åº”è¯¥å†™åœ¨æœåŠ¡ç±»ä¸­ä¸è¦é‡å¤è‡ªå·±çš„ä»£ç (DRY)å°½é‡ä½¿ç”¨Eloquentä¸collectionsåšæ•°æ®åº“æŸ¥è¯¢æ‰¹é‡èµ‹å€¼ä¸è¦åœ¨Bladeæ¨¡æ¿ä¸­åšæŸ¥è¯¢ï¼Œä½¿ç”¨å®æ—¶åŠ è½½(N+1é—®é¢˜)ç»™ä»£ç æ·»åŠ æ³¨é‡Šï¼Œå°½é‡ä½¿ç”¨æè¿°æ€§çš„æ–¹æ³•å’Œå˜é‡åæ¥å–ä»£ä»£ç æ³¨é‡ŠBladeæ¨¡æ¿ä¸­ä¸è¦åŠ JSå’ŒCSSï¼Œä¸è¦åœ¨PHPç±»ä¸­åŠ HTMLä½¿ç”¨é…ç½®ã€è¯­è¨€æ–‡ä»¶å’Œå®šä¹‰å¸¸é‡æ¥å–ä»£ä»£ç ä¸­çš„æ–‡å­—ä½¿ç”¨è¢«ç¤¾åŒºå¹¿ä¸ºæ¥å—çš„æ ‡å‡†Laravelå·¥å…·éµå¾ªLaravelå‘½åè§„èŒƒåœ¨å¯èƒ½çš„åœ°æ–¹ä½¿ç”¨æ›´çŸ­å¯è¯»æ€§æ›´å¼ºçš„å¥æ³•ç”¨æ§åˆ¶åè½¬å®¹å™¨æˆ–é—¨é¢æ¥å–ä»£newä¸€ä¸ªæ–°çš„å¯¹è±¡ä¸è¦ç›´æ¥ä».envæ–‡ä»¶ä¸­è¯»å–æ•°æ®ä»¥æ ‡å‡†æ ¼å¼å­˜å‚¨æ•°æ®ï¼Œä½¿ç”¨å­˜å–å™¨å’Œå˜å¼‚å™¨æ¥ä¿®æ”¹æ—¥æœŸæ ¼å¼å…¶ä»–å¥½çš„å®è·µ single-responsibility-principleå•ä¸€è´£ä»»åŸåˆ™ä¸€ä¸ªç±»ï¼Œä¸€ä¸ªæ–¹æ³•åº”è¯¥åªåšä¸€ä»¶äº‹æƒ… ä¸å¥½çš„åšæ³•ï¼š 12345678public function getFullNameAttribute()&#123; if (auth()-&gt;user() &amp;&amp; auth()-&gt;user()-&gt;hasRole('client') &amp;&amp; auth()-&gt;user()-&gt;isVerified()) &#123; return 'Mr. ' . $this-&gt;first_name . ' ' . $this-&gt;middle_name . ' ' . $this-&gt;last_name; &#125; else &#123; return $this-&gt;first_name[0] . '. ' . $this-&gt;last_name; &#125;&#125; å¥½çš„åšæ³•ï¼š 12345678910111213141516171819public function getFullNameAttribute()&#123; return $this-&gt;isVerifiedClient() ? $this-&gt;getFullNameLong() : $this-&gt;getFullNameShort();&#125;public function isVerifiedClient()&#123; return auth()-&gt;user() &amp;&amp; auth()-&gt;user()-&gt;hasRole('client') &amp;&amp; auth()-&gt;user()-&gt;isVerified();&#125;public function getFullNameLong()&#123; return 'Mr. ' . $this-&gt;first_name . ' ' . $this-&gt;middle_name . ' ' . $this-&gt;last_name;&#125;public function getFullNameShort()&#123; return $this-&gt;first_name[0] . '. ' . $this-&gt;last_name;&#125; ğŸ” å›åˆ°é¡¶éƒ¨ fat-models-skinny-controllersèƒ–æ¨¡å‹ï¼Œç˜¦æ§åˆ¶å™¨ä¸è¦ä½¿ç”¨æŸ¥è¯¢æ„é€ å™¨æˆ–SQLè¯­å¥æ¥æŸ¥è¯¢æ•°æ®åº“ï¼ŒæŠŠæ‰€æœ‰æœ‰å…³æ•°æ®åº“æ“ä½œçš„ä»£ç å†™åœ¨Eloquentæ¨¡å‹æˆ–Repositoryç±»ä¸­ ä¸å¥½çš„åšæ³•ï¼š 12345678910public function index()&#123; $clients = Client::verified() -&gt;with(['orders' =&gt; function ($q) &#123; $q-&gt;where('created_at', '&gt;', Carbon::today()-&gt;subWeek()); &#125;]) -&gt;get(); return view('index', ['clients' =&gt; $clients]);&#125; å¥½çš„åšæ³•ï¼š 12345678910111213141516public function index()&#123; return view('index', ['clients' =&gt; $this-&gt;client-&gt;getWithNewOrders()]);&#125;class Client extends Model&#123; public function getWithNewOrders() &#123; return $this-&gt;verified() -&gt;with(['orders' =&gt; function ($q) &#123; $q-&gt;where('created_at', '&gt;', Carbon::today()-&gt;subWeek()); &#125;]) -&gt;get(); &#125;&#125; ğŸ” å›åˆ°é¡¶éƒ¨ validationæ ¡éªŒæŠŠè¡¨å•æ ¡éªŒé€»è¾‘ä»æ§åˆ¶å™¨æŒªåˆ°è¯·æ±‚ç±»ä¸­ ä¸å¥½çš„åšæ³• 12345678910public function store(Request $request)&#123; $request-&gt;validate([ 'title' =&gt; 'required|unique:posts|max:255', 'body' =&gt; 'required', 'publish_at' =&gt; 'nullable|date', ]); ....&#125; å¥½çš„åšæ³•ï¼š 12345678910111213141516public function store(PostRequest $request)&#123; ....&#125;class PostRequest extends Request&#123; public function rules() &#123; return [ 'title' =&gt; 'required|unique:posts|max:255', 'body' =&gt; 'required', 'publish_at' =&gt; 'nullable|date', ]; &#125;&#125; ğŸ” å›åˆ°é¡¶éƒ¨ business-logic-should-be-in-service-classä¸šåŠ¡é€»è¾‘åº”è¯¥å†™åœ¨æœåŠ¡ç±»ä¸­ä¸€ä¸ªæ§åˆ¶å™¨å¿…é¡»åªåšä¸€ä»¶äº‹æƒ…ï¼Œå› æ­¤æŠŠä¸šåŠ¡é€»è¾‘ä»æ§åˆ¶å™¨æŒªåˆ°æœåŠ¡ç±»ä¸­ ä¸å¥½çš„åšæ³•ï¼š 12345678public function store(Request $request)&#123; if ($request-&gt;hasFile('image')) &#123; $request-&gt;file('image')-&gt;move(public_path('images') . 'temp'); &#125; ....&#125; å¥½çš„åšæ³•ï¼š 12345678910111213141516public function store(Request $request)&#123; $this-&gt;articleService-&gt;handleUploadedImage($request-&gt;file('image')); ....&#125;class ArticleService&#123; public function handleUploadedImage($image) &#123; if (!is_null($image)) &#123; $image-&gt;move(public_path('images') . 'temp'); &#125; &#125;&#125; ğŸ” å›åˆ°é¡¶éƒ¨ dont-repeat-yourself-dryä¸è¦é‡å¤è‡ªå·±çš„ä»£ç (DRY)å°½å¯èƒ½çš„å¤ç”¨ä»£ç ï¼ŒåŒ…æ‹¬bladeæ¨¡æ¿ä¸­çš„ä»£ç å’Œä½¿ç”¨Eloquent scope ä¸å¥½çš„åšæ³•ï¼š 1234567891011public function getActive()&#123; return $this-&gt;where('verified', 1)-&gt;whereNotNull('deleted_at')-&gt;get();&#125;public function getArticles()&#123; return $this-&gt;whereHas('user', function ($q) &#123; $q-&gt;where('verified', 1)-&gt;whereNotNull('deleted_at'); &#125;)-&gt;get();&#125; å¥½çš„åšæ³•ï¼š 12345678910111213141516public function scopeActive($q)&#123; return $q-&gt;where('verified', 1)-&gt;whereNotNull('deleted_at');&#125;public function getActive()&#123; return $this-&gt;active()-&gt;get();&#125;public function getArticles()&#123; return $this-&gt;whereHas('user', function ($q) &#123; $q-&gt;active(); &#125;)-&gt;get();&#125; ğŸ” å›åˆ°é¡¶éƒ¨ Prefer to use Eloquent over using Query Builder and raw SQL queries. Prefer collections over arrayså°½é‡ä½¿ç”¨Eloquentä¸collectionsåšæ•°æ®åº“æŸ¥è¯¢Eloquentè®©ä½ å¯ä»¥å†™å‡ºå¯è¯»æ€§å¼ºã€å¯ç»´æŠ¤æ€§å¼ºçš„ä»£ç ï¼Œå®ƒè¿˜æ”¯æŒè½¯åˆ é™¤ã€äº‹ä»¶æ“ä½œç­‰ç­‰ä¼˜åŠ¿ ä¸å¥½çš„åšæ³•ï¼š 123456789101112SELECT *FROM `articles`WHERE EXISTS (SELECT * FROM `users` WHERE `articles`.`user_id` = `users`.`id` AND EXISTS (SELECT * FROM `profiles` WHERE `profiles`.`user_id` = `users`.`id`) AND `users`.`deleted_at` IS NULL)AND `verified` = '1'AND `active` = '1'ORDER BY `created_at` DESC å¥½çš„åšæ³•ï¼š 1Article::has('user.profile')-&gt;verified()-&gt;latest()-&gt;get(); ğŸ” å›åˆ°é¡¶éƒ¨ Mass assignmentæ‰¹é‡èµ‹å€¼ä¸å¥½çš„åšæ³•ï¼š 1234567$article = new Article;$article-&gt;title = $request-&gt;title;$article-&gt;content = $request-&gt;content;$article-&gt;verified = $request-&gt;verified;// Add category to article$article-&gt;category_id = $category-&gt;id;$article-&gt;save(); å¥½çš„åšæ³•ï¼š 1$category-&gt;article()-&gt;create($request-&gt;all()); ğŸ” å›åˆ°é¡¶éƒ¨ Do not execute queries in Blade templates and use eager loading (N + 1 problem)ä¸è¦åœ¨Bladeæ¨¡æ¿ä¸­åšæŸ¥è¯¢ï¼Œä½¿ç”¨å®æ—¶åŠ è½½(N+1é—®é¢˜)ä¸å¥½çš„åšæ³•ï¼ˆå¯¹äº100ä¸ªç”¨æˆ·ï¼Œåšäº†101æ¬¡æŸ¥è¯¢ï¼‰ï¼š 123@foreach (User::all() as $user) &#123;&#123; $user-&gt;profile-&gt;name &#125;&#125;@endforeach å¥½çš„åšæ³•ï¼ˆå¯¹äº100ä¸ªç”¨æˆ·ï¼Œåªåšäº†ä¸¤æ¬¡æŸ¥è¯¢ï¼‰ï¼š 1234567$users = User::with('profile')-&gt;get();...@foreach ($users as $user) &#123;&#123; $user-&gt;profile-&gt;name &#125;&#125;@endforeach ğŸ” å›åˆ°é¡¶éƒ¨ Comment your code, but prefer descriptive method and variable names over commentsç»™ä»£ç æ·»åŠ æ³¨é‡Šï¼Œå°½é‡ä½¿ç”¨æè¿°æ€§çš„æ–¹æ³•å’Œå˜é‡åæ¥å–ä»£ä»£ç æ³¨é‡Šä¸å¥½çš„åšæ³•ï¼š 1if (count((array) $builder-&gt;getQuery()-&gt;joins) &gt; 0) å¥½ä¸€äº›çš„åšæ³•ï¼š 12// Determine if there are any joins.if (count((array) $builder-&gt;getQuery()-&gt;joins) &gt; 0) å¾ˆå¥½çš„åšæ³•ï¼š 1if ($this-&gt;hasJoins()) ğŸ” å›åˆ°é¡¶éƒ¨ Do not put JS and CSS in Blade templates and do not put any HTML in PHP classesBladeæ¨¡æ¿ä¸­ä¸è¦åŠ JSå’ŒCSSï¼Œä¸è¦åœ¨PHPç±»ä¸­åŠ HTMLä¸å¥½çš„åšæ³•ï¼š 1let article = `&#123;&#123; json_encode($article) &#125;&#125;`; å¥½ä¸€äº›çš„åšæ³•ï¼š 12345&lt;input id=\"article\" type=\"hidden\" value=\"@json($article)\"&gt;Or&lt;button class=\"js-fav-article\" data-article=\"@json($article)\"&gt;&#123;&#123; $article-&gt;name &#125;&#125;&lt;button&gt; åœ¨Javascriptæ–‡ä»¶ä¸­ï¼š 1let article = $('#article').val(); æœ€å¥½ç”¨ä¸“é—¨çš„ä»£ç åœ¨PHPç«¯åŒ…è£…æ•°æ®ï¼Œåœ¨JSç«¯è§£ææ•°æ® ğŸ” å›åˆ°é¡¶éƒ¨ Use config and language files, constants instead of text in the codeä½¿ç”¨é…ç½®ã€è¯­è¨€æ–‡ä»¶å’Œå®šä¹‰å¸¸é‡æ¥å–ä»£ä»£ç ä¸­çš„æ–‡å­—ä¸å¥½çš„åšæ³•ï¼š 123456public function isNormal()&#123; return $article-&gt;type === 'normal';&#125;return back()-&gt;with('message', 'Your article has been added!'); å¥½çš„åšæ³•ï¼š 123456public function isNormal()&#123; return $article-&gt;type === Article::TYPE_NORMAL;&#125;return back()-&gt;with('message', __('app.article_added')); ğŸ” å›åˆ°é¡¶éƒ¨ Use standard Laravel tools accepted by communityä½¿ç”¨è¢«ç¤¾åŒºå¹¿ä¸ºæ¥å—çš„æ ‡å‡†Laravelå·¥å…·ä¸è¦ä»»æ„ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åŒ…å’Œå·¥å…·ï¼Œè¦é€‰ç”¨è¢«ç¤¾åŒºå¹¿ä¸ºæ¥å—çš„æ ‡å‡†Laravelå·¥å…·ï¼Œä¸è¦å‘ä½ çš„å®¢æˆ· ä»»åŠ¡ æ ‡å‡†å·¥å…· ç¬¬ä¸‰æ–¹å·¥å…· Authorization Policies Entrust, Sentinel and other packages Compiling assets Laravel Mix Grunt, Gulp, 3rd party packages Development Environment Homestead Docker Deployment Laravel Forge Deployer and other solutions Unit testing PHPUnit, Mockery Phpspec Browser testing Laravel Dusk Codeception DB Eloquent SQL, Doctrine Templates Blade Twig Working with data Laravel collections Arrays Form validation Request classes 3rd party packages, validation in controller Authentication Built-in 3rd party packages, your own solution API authentication Laravel Passport 3rd party JWT and OAuth packages Creating API Built-in Dingo API and similar packages Working with DB structure Migrations Working with DB structure directly Localization Built-in 3rd party packages Realtime user interfaces Laravel Echo, Pusher 3rd party packages and working with WebSockets directly Generating testing data Seeder classes, Model Factories, Faker Creating testing data manually Task scheduling Laravel Task Scheduler Scripts and 3rd party packages DB MySQL, PostgreSQL, SQLite, SQL Server MongoDB ğŸ” å›åˆ°é¡¶éƒ¨ Follow Laravel naming conventionséµå¾ªLaravelå‘½åè§„èŒƒéµå¾ªPSRè§„èŒƒ PSRæ ‡å‡† åŒæ—¶éµå¾ªLaravelç¤¾åŒºæ¥å—çš„å‘½åä¼ ç»Ÿ ç§°å‘¼ä»€ä¹ˆ æ€ä¹ˆæ ·çš„ å¥½çš„ ä¸å¥½çš„ Controller singular ArticleController ArticlesController Route plural articles/1 article/1 Named route snake_case with dot notation users.show_active users.show-active, show-active-users Model singular User Users hasOne or belongsTo relationship singular articleComment articleComments, article_comment All other relationships plural articleComments articleComment, article_comments Table plural article_comments article_comment, articleComments Pivot table singular model names in alphabetical order article_user user_article, articles_users Table column snake_case without model name meta_title MetaTitle; article_meta_title Model property snake_case $model-&gt;created_at $model-&gt;createdAt Foreign key singular model name with _id suffix article_id ArticleId, id_article, articles_id Primary key - id custom_id Migration - 2017_01_01_000000_create_articles_table 2017_01_01_000000_articles Method camelCase getAll get_all Method in resource controller table store saveArticle Method in test class camelCase testGuestCannotSeeArticle test_guest_cannot_see_article Variable camelCase $articlesWithAuthor $articles_with_author Collection descriptive, plural $activeUsers = User::active()-&gt;get() $active, $data Object descriptive, singular $activeUser = User::active()-&gt;first() $users, $obj Config and language files index snake_case articles_enabled ArticlesEnabled; articles-enabled View snake_case show_filtered.blade.php showFiltered.blade.php, show-filtered.blade.php Config snake_case google_calendar.php googleCalendar.php, google-calendar.php Contract (interface) adjective or noun Authenticatable AuthenticationInterface, IAuthentication Trait adjective Notifiable NotificationTrait ğŸ” å›åˆ°é¡¶éƒ¨ Use shorter and more readable syntax where possibleåœ¨å¯èƒ½çš„åœ°æ–¹ä½¿ç”¨æ›´çŸ­å¯è¯»æ€§æ›´å¼ºçš„å¥æ³•ä¸å¥½çš„åšæ³•ï¼š 12$request-&gt;session()-&gt;get('cart');$request-&gt;input('name'); å¥½çš„åšæ³•ï¼š 12session('cart');$request-&gt;name; æ›´å¤šçš„ä¾‹å­ï¼š ä¸€èˆ¬çš„å¥æ³• çŸ­å°ç²¾æ‚çš„å¥æ³• Session::get(&#39;cart&#39;) session(&#39;cart&#39;) $request-&gt;session()-&gt;get(&#39;cart&#39;) session(&#39;cart&#39;) Session::put(&#39;cart&#39;, $data) session([&#39;cart&#39; =&gt; $data]) $request-&gt;input(&#39;name&#39;), Request::get(&#39;name&#39;) $request-&gt;name, request(&#39;name&#39;) return Redirect::back() return back() is_null($object-&gt;relation) ? null : $object-&gt;relation-&gt;id optional($object-&gt;relation)-&gt;id return view(&#39;index&#39;)-&gt;with(&#39;title&#39;, $title)-&gt;with(&#39;client&#39;, $client) return view(&#39;index&#39;, compact(&#39;title&#39;, &#39;client&#39;)) $request-&gt;has(&#39;value&#39;) ? $request-&gt;value : &#39;default&#39;; $request-&gt;get(&#39;value&#39;, &#39;default&#39;) Carbon::now(), Carbon::today() now(), today() App::make(&#39;Class&#39;) app(&#39;Class&#39;) -&gt;where(&#39;column&#39;, &#39;=&#39;, 1) -&gt;where(&#39;column&#39;, 1) -&gt;orderBy(&#39;created_at&#39;, &#39;desc&#39;) -&gt;latest() -&gt;orderBy(&#39;age&#39;, &#39;desc&#39;) -&gt;latest(&#39;age&#39;) -&gt;orderBy(&#39;created_at&#39;, &#39;asc&#39;) -&gt;oldest() -&gt;select(&#39;id&#39;, &#39;name&#39;)-&gt;get() -&gt;get([&#39;id&#39;, &#39;name&#39;]) -&gt;first()-&gt;name -&gt;value(&#39;name&#39;) ğŸ” å›åˆ°é¡¶éƒ¨ Use IoC container or facades instead of new Classç”¨æ§åˆ¶åè½¬å®¹å™¨æˆ–é—¨é¢æ¥å–ä»£newä¸€ä¸ªæ–°çš„å¯¹è±¡newä¸€ä¸ªæ–°çš„å¯¹è±¡çš„è¿™ç§åšæ³•é€ æˆäº†ç±»ä¸å¤æ‚æµ‹è¯•ä¹‹é—´çš„å¼ºè€¦åˆï¼Œå°½é‡ä½¿ç”¨æ§åˆ¶åè½¬æˆ–é—¨é¢ ä¸å¥½çš„åšæ³•ï¼š 12$user = new User;$user-&gt;create($request-&gt;all()); å¥½çš„åšæ³•ï¼š 12345678public function __construct(User $user)&#123; $this-&gt;user = $user;&#125;....$this-&gt;user-&gt;create($request-&gt;all()); ğŸ” å›åˆ°é¡¶éƒ¨ Do not get data from the .env file directlyä¸è¦ç›´æ¥ä».envæ–‡ä»¶ä¸­è¯»å–æ•°æ®æŠŠ.envæ–‡ä»¶ä¸­çš„æ•°æ®å…ˆä¼ é€’åˆ°configæ–‡ä»¶ä¸­ï¼Œå†åœ¨åº”ç”¨ä¸­é€šè¿‡config()å¸®åŠ©æ–¹æ³•ä½¿ç”¨ ä¸å¥½çš„åšæ³•ï¼š 1$apiKey = env('API_KEY'); å¥½çš„åšæ³•ï¼š 12345// config/api.php'key' =&gt; env('API_KEY'),// Use the data$apiKey = config('api.key'); ğŸ” å›åˆ°é¡¶éƒ¨ Store dates in the standard format. Use accessors and mutators to modify date formatä»¥æ ‡å‡†æ ¼å¼å­˜å‚¨æ•°æ®ï¼Œä½¿ç”¨å­˜å–å™¨å’Œå˜å¼‚å™¨æ¥ä¿®æ”¹æ—¥æœŸæ ¼å¼ä¸å¥½çš„åšæ³•ï¼š 12&#123;&#123; Carbon::createFromFormat('Y-d-m H-i', $object-&gt;ordered_at)-&gt;toDateString() &#125;&#125;&#123;&#123; Carbon::createFromFormat('Y-d-m H-i', $object-&gt;ordered_at)-&gt;format('m-d') &#125;&#125; å¥½çš„åšæ³•ï¼š 12345678910// Modelprotected $dates = ['ordered_at', 'created_at', 'updated_at']public function getSomeDateAttribute($date)&#123; return $date-&gt;format('m-d');&#125;// View&#123;&#123; $object-&gt;ordered_at-&gt;toDateString() &#125;&#125;&#123;&#123; $object-&gt;ordered_at-&gt;some_date &#125;&#125; ğŸ” å›åˆ°é¡¶éƒ¨ Other good practiceså…¶ä»–å¥½çš„å®è·µä¸è¦åœ¨è·¯å¾„æ–‡ä»¶é‡Œå†™ä»»ä½•çš„é€»è¾‘ Bladeæ¨¡æ¿ä¸­å°½é‡ä¸è¦ä½¿ç”¨åŸç”Ÿçš„PHPè¯­æ³• ğŸ” å›åˆ°é¡¶éƒ¨","categories":[],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"http://blog.guoguojia.net/tags/Laravel/"},{"name":"å®è·µ","slug":"å®è·µ","permalink":"http://blog.guoguojia.net/tags/å®è·µ/"}]},{"title":"è¿™æ˜¯ç¬¬ä¸€ç¯‡æµ‹è¯•æ–‡ç« ","slug":"first-post","date":"2019-01-01T08:56:33.000Z","updated":"2019-01-01T08:56:33.989Z","comments":true,"path":"2019/01/01/first-post/","link":"","permalink":"http://blog.guoguojia.net/2019/01/01/first-post/","excerpt":"","text":"æµ‹è¯•è¿™é‡Œæ˜¯ç¬¬ä¸€ç¯‡æ–‡ç« ","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://blog.guoguojia.net/categories/Hexo/"}],"tags":[{"name":"æµ‹è¯•","slug":"æµ‹è¯•","permalink":"http://blog.guoguojia.net/tags/æµ‹è¯•/"},{"name":"MD","slug":"MD","permalink":"http://blog.guoguojia.net/tags/MD/"}]},{"title":"Hello World","slug":"hello-world","date":"2019-01-01T08:41:05.054Z","updated":"2019-01-01T08:41:05.054Z","comments":true,"path":"2019/01/01/hello-world/","link":"","permalink":"http://blog.guoguojia.net/2019/01/01/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}